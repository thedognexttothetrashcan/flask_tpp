# TPP


## Viewer 用户端
- 用户系统
- 选座
    - 根据排挡选座
    - 可以对应的放映厅
    - 可以获取放映座位信息
    - 座位信息需要筛选
        - 要将卖出的（订单）和锁单（订单的一种状态）的从座位表中剔除
- 下单
    - 通过座位信息进行选择
    - 生成订单
    - 十五分钟之内支付
        - 未付款且订单在有效期内（锁单）
    - 支付
    
    
### 并发
- 拖延
    - 可以减少并发量
- 变并行为串行
    - 添加到队列中
    - 队列单例
- 加锁
    - 乐观锁
        - 咱们在买的时候不会买
        - 买之前一个座位表
        - 买之后又是一个座位表
        - 买之前和之后的差值就是我们的数据
        - 不符合预期，自我删除
    - 悲观锁
        - 数据加锁
        - redis locked
        
### 复杂聚合
- 票房排行
    - 基于电影
    - 电影票的总价
    - 关联表
        - 电影
        - 电影票
            - 排挡
                - 电影
                - 大厅
    - 电影
        - 排挡
            - 1:M
                - 影票
                    - 1：M
        - 1：M
    - 影票总钱数
        - 使用join

### 部署
- Nginx

### 页面数据加密

### 大型项目体系